<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Propuesta: Automatizaci√≥n de Renombrado de Facturas</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        header {
            background: linear-gradient(135deg, #0078d4 0%, #0053a0 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        h2 {
            color: #0078d4;
            margin-top: 30px;
            margin-bottom: 15px;
            font-size: 1.8em;
            border-bottom: 3px solid #0078d4;
            padding-bottom: 10px;
        }

        h3 {
            color: #0053a0;
            margin-top: 20px;
            margin-bottom: 10px;
            font-size: 1.4em;
        }

        h4 {
            color: #333;
            margin-top: 15px;
            margin-bottom: 10px;
            font-size: 1.2em;
        }

        .icon {
            font-size: 1.5em;
            margin-right: 10px;
        }

        .card {
            background: #f8f9fa;
            border-left: 4px solid #0078d4;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .card-success {
            border-left-color: #28a745;
        }

        .card-warning {
            border-left-color: #ffc107;
        }

        .card-info {
            border-left-color: #17a2b8;
        }

        ul, ol {
            margin-left: 30px;
            margin-top: 10px;
            margin-bottom: 15px;
        }

        li {
            margin: 8px 0;
        }

        .flow-diagram {
            background: #f0f4f8;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            white-space: pre-line;
        }

        .pros-cons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 20px 0;
        }

        .pros {
            background: #d4edda;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #28a745;
        }

        .cons {
            background: #fff3cd;
            padding: 15px;
            border-radius: 8px;
            border: 2px solid #ffc107;
        }

        .architecture {
            background: #2d2d2d;
            color: #00ff00;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            margin: 20px 0;
            overflow-x: auto;
        }

        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .comparison-table th,
        .comparison-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }

        .comparison-table th {
            background: #0078d4;
            color: white;
        }

        .comparison-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .highlight {
            background: #fff3cd;
            padding: 2px 6px;
            border-radius: 3px;
            font-weight: bold;
        }

        .phase {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
        }

        .phase h4 {
            color: white;
            margin: 0 0 10px 0;
        }

        .phase ul {
            margin-left: 20px;
        }

        footer {
            background: #2d2d2d;
            color: white;
            text-align: center;
            padding: 20px;
            margin-top: 40px;
        }

        .tech-stack {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .tech-item {
            background: white;
            border: 2px solid #0078d4;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
        }

        .tech-item h4 {
            color: #0078d4;
            margin-bottom: 10px;
        }

        @media (max-width: 768px) {
            .pros-cons {
                grid-template-columns: 1fr;
            }
            
            header h1 {
                font-size: 1.8em;
            }
            
            .content {
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>üìÑ Automatizaci√≥n de Renombrado de Facturas</h1>
            <p>Soluci√≥n con Microsoft 365</p>
            <p style="font-size: 0.9em; margin-top: 10px;">Proyecto: Renombrar_facturas</p>
        </header>

        <div class="content">
            <!-- Objetivo del Proyecto -->
            <section>
                <h2>üéØ Objetivo del Proyecto</h2>
                <div class="card card-info">
                    <p><strong>Automatizar el proceso de renombrado y organizaci√≥n de facturas</strong> recibidas en diversos formatos (PDF e im√°genes), extrayendo informaci√≥n clave como:</p>
                    <ul>
                        <li><strong>Fecha de la factura</strong></li>
                        <li><strong>Nombre del proveedor</strong></li>
                        <li><strong>N√∫mero de factura</strong></li>
                    </ul>
                    <p>Las facturas ser√°n renombradas autom√°ticamente con estos datos y organizadas en carpetas espec√≠ficas.</p>
                </div>
            </section>

            <!-- Contexto -->
            <section>
                <h2>üìã Contexto del Problema</h2>
                <div class="card">
                    <ul>
                        <li><strong>Volumen:</strong> Pueden llegar hasta <span class="highlight">50 tipos de facturas diferentes</span></li>
                        <li><strong>Formatos:</strong> PDF (nativos y escaneados) e im√°genes (JPG/PNG)</li>
                        <li><strong>Proceso manual:</strong> Actualmente requiere tiempo y es propenso a errores</li>
                        <li><strong>Necesidad:</strong> Automatizaci√≥n completa del proceso</li>
                    </ul>
                </div>
            </section>

            <!-- Soluci√≥n Recomendada -->
            <section>
                <h2>üî∑ Soluci√≥n Recomendada: Microsoft 365</h2>
                
                <div class="tech-stack">
                    <div class="tech-item">
                        <h4>Power Automate</h4>
                        <p>Orquestaci√≥n del flujo de trabajo completo</p>
                    </div>
                    <div class="tech-item">
                        <h4>AI Builder</h4>
                        <p>OCR y extracci√≥n inteligente de datos</p>
                    </div>
                    <div class="tech-item">
                        <h4>SharePoint/OneDrive</h4>
                        <p>Almacenamiento y gesti√≥n de documentos</p>
                    </div>
                    <div class="tech-item">
                        <h4>Azure Form Recognizer</h4>
                        <p>OCR avanzado (opcional)</p>
                    </div>
                </div>

                <h3>‚úÖ Ventajas de Microsoft 365</h3>
                <div class="card card-success">
                    <ul>
                        <li>‚úì <strong>Sin c√≥digo</strong> o low-code</li>
                        <li>‚úì <strong>Ya licenciado</strong> (si tienen M365 E3/E5)</li>
                        <li>‚úì <strong>Integraci√≥n nativa</strong> con todo el ecosistema Microsoft</li>
                        <li>‚úì <strong>OCR incluido</strong> en AI Builder</li>
                        <li>‚úì <strong>Mantenimiento m√≠nimo</strong></li>
                        <li>‚úì <strong>Auditor√≠a autom√°tica</strong> de todos los procesos</li>
                        <li>‚úì <strong>Escalable</strong> seg√∫n las necesidades</li>
                    </ul>
                </div>
            </section>

            <!-- Flujo del Proceso -->
            <section>
                <h2>üîÑ Flujo del Proceso Automatizado</h2>
                <div class="flow-diagram">
1. üì• Nuevo archivo detectado en carpeta SharePoint/OneDrive
   ‚Üì
2. ü§ñ Power Automate se activa autom√°ticamente
   ‚Üì
3. üîç AI Builder procesa el documento:
   ‚Ä¢ Extrae texto (OCR)
   ‚Ä¢ Identifica campos: fecha, proveedor, n√∫mero de factura
   ‚Üì
4. ‚úì Valida que los datos extra√≠dos sean correctos
   ‚Üì
5. ‚úèÔ∏è Renombra archivo: "YYYYMMDD_Proveedor_NumFactura.pdf"
   ‚Üì
6. üìÇ Mueve archivo a carpeta de salida
   ‚Üì
7. üìß (Opcional) Env√≠a notificaci√≥n o registra en Excel/SharePoint List
                </div>
            </section>

            <!-- Opciones de Implementaci√≥n -->
            <section>
                <h2>üíº Opciones de Implementaci√≥n</h2>

                <h3>Opci√≥n A: Power Automate + AI Builder (Recomendado)</h3>
                <div class="card card-success">
                    <table class="comparison-table">
                        <tr>
                            <th>Caracter√≠stica</th>
                            <th>Detalle</th>
                        </tr>
                        <tr>
                            <td><strong>Licencia</strong></td>
                            <td>M365 E3/E5 o cr√©ditos AI Builder</td>
                        </tr>
                        <tr>
                            <td><strong>Complejidad</strong></td>
                            <td>Baja - Interfaz visual</td>
                        </tr>
                        <tr>
                            <td><strong>Mantenimiento</strong></td>
                            <td>Muy bajo</td>
                        </tr>
                        <tr>
                            <td><strong>Tiempo de implementaci√≥n</strong></td>
                            <td>2-3 semanas</td>
                        </tr>
                        <tr>
                            <td><strong>Ideal para</strong></td>
                            <td>Empresas con Microsoft 365</td>
                        </tr>
                    </table>
                </div>

                <h3>Opci√≥n B: Power Automate + Azure Form Recognizer</h3>
                <div class="card card-warning">
                    <table class="comparison-table">
                        <tr>
                            <th>Caracter√≠stica</th>
                            <th>Detalle</th>
                        </tr>
                        <tr>
                            <td><strong>Licencia</strong></td>
                            <td>Azure (pago por uso)</td>
                        </tr>
                        <tr>
                            <td><strong>Complejidad</strong></td>
                            <td>Media - Requiere configuraci√≥n Azure</td>
                        </tr>
                        <tr>
                            <td><strong>Precisi√≥n</strong></td>
                            <td>Mayor - Especializado en facturas</td>
                        </tr>
                        <tr>
                            <td><strong>Tiempo de implementaci√≥n</strong></td>
                            <td>3-4 semanas</td>
                        </tr>
                        <tr>
                            <td><strong>Ideal para</strong></td>
                            <td>Alto volumen y m√°xima precisi√≥n</td>
                        </tr>
                    </table>
                </div>
            </section>

            <!-- Alternativa: Python -->
            <section>
                <h2>üêç Alternativa: Soluci√≥n Python</h2>
                <p>Si prefieren mayor control o no tienen acceso completo a Microsoft 365:</p>

                <h3>Librer√≠as Principales</h3>
                <div class="card">
                    <ul>
                        <li><strong>pdfplumber / PyMuPDF:</strong> Extracci√≥n de texto de PDFs</li>
                        <li><strong>pytesseract + Tesseract-OCR:</strong> OCR gratuito</li>
                        <li><strong>pdf2image:</strong> Conversi√≥n de PDF a imagen</li>
                        <li><strong>Pillow (PIL):</strong> Procesamiento de im√°genes</li>
                        <li><strong>OpenAI/Claude API:</strong> Extracci√≥n inteligente con IA</li>
                        <li><strong>re (regex):</strong> B√∫squeda de patrones</li>
                    </ul>
                </div>

                <h3>Arquitectura Python</h3>
                <div class="architecture">
proyecto/
‚îú‚îÄ‚îÄ input/              # Carpeta con facturas sin procesar
‚îú‚îÄ‚îÄ output/             # Carpeta con facturas renombradas
‚îú‚îÄ‚îÄ logs/               # Registro de procesamiento
‚îú‚îÄ‚îÄ config.py           # Configuraci√≥n (patrones, proveedores)
‚îú‚îÄ‚îÄ extractor.py        # Extrae texto de PDF/im√°genes
‚îú‚îÄ‚îÄ parser.py           # Identifica fecha, proveedor, n¬∫ factura
‚îú‚îÄ‚îÄ renamer.py          # Renombra y mueve archivos
‚îî‚îÄ‚îÄ main.py             # Ejecuta todo el proceso
                </div>

                <div class="pros-cons">
                    <div class="pros">
                        <h4>‚úÖ Ventajas</h4>
                        <ul>
                            <li>Control total del c√≥digo</li>
                            <li>Gratuito (excepto APIs de IA)</li>
                            <li>Muy flexible</li>
                            <li>Personalizable al 100%</li>
                        </ul>
                    </div>
                    <div class="cons">
                        <h4>‚ö†Ô∏è Desventajas</h4>
                        <ul>
                            <li>Requiere desarrollo</li>
                            <li>Mayor mantenimiento</li>
                            <li>Necesita expertise t√©cnico</li>
                            <li>Infraestructura adicional</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Plan de Implementaci√≥n -->
            <section>
                <h2>üéØ Plan de Implementaci√≥n (Microsoft 365)</h2>

                <div class="phase">
                    <h4>üìå Fase 1: Estructura B√°sica (1 semana)</h4>
                    <ul>
                        <li>Crear estructura de carpetas en SharePoint/OneDrive</li>
                        <li>Configurar Power Automate b√°sico</li>
                        <li>Probar con 5-10 facturas de ejemplo</li>
                        <li>Validar flujo b√°sico de trabajo</li>
                    </ul>
                </div>

                <div class="phase">
                    <h4>üìå Fase 2: Integraci√≥n AI Builder (1-2 semanas)</h4>
                    <ul>
                        <li>Crear modelo de AI Builder para facturas</li>
                        <li>Entrenar con ejemplos de proveedores reales</li>
                        <li>Integrar OCR en el flujo</li>
                        <li>Pruebas con diferentes tipos de facturas</li>
                    </ul>
                </div>

                <div class="phase">
                    <h4>üìå Fase 3: Refinamiento (1 semana)</h4>
                    <ul>
                        <li>A√±adir validaciones de datos</li>
                        <li>Implementar manejo de errores</li>
                        <li>Configurar notificaciones</li>
                        <li>Crear dashboard de seguimiento</li>
                        <li>Documentaci√≥n del proceso</li>
                    </ul>
                </div>

                <div class="card card-info">
                    <h4>‚è±Ô∏è Tiempo Total Estimado</h4>
                    <p><strong>3-4 semanas</strong> para implementaci√≥n completa</p>
                </div>
            </section>

            <!-- Formato de Nomenclatura -->
            <section>
                <h2>üìù Formato de Nomenclatura Propuesto</h2>
                <div class="card">
                    <h4>Formato del nombre de archivo:</h4>
                    <p style="font-family: 'Courier New', monospace; font-size: 1.2em; background: #f0f4f8; padding: 15px; border-radius: 5px; margin: 10px 0;">
                        <strong>YYYYMMDD_NombreProveedor_NumeroFactura.pdf</strong>
                    </p>
                    
                    <h4>Ejemplo:</h4>
                    <p style="font-family: 'Courier New', monospace; font-size: 1.1em; background: #d4edda; padding: 15px; border-radius: 5px; margin: 10px 0;">
                        20251001_Iberdrola_FAC2024-12345.pdf
                    </p>
                    
                    <h4>Ventajas de este formato:</h4>
                    <ul>
                        <li>‚úì Ordenaci√≥n cronol√≥gica autom√°tica</li>
                        <li>‚úì F√°cil b√∫squeda por proveedor</li>
                        <li>‚úì Referencia √∫nica por n√∫mero de factura</li>
                        <li>‚úì Compatible con todos los sistemas</li>
                    </ul>
                </div>
            </section>

            <!-- Estructura de Carpetas -->
            <section>
                <h2>üìÅ Estructura de Carpetas Propuesta</h2>
                <div class="architecture">
üìÇ Facturas/
‚îú‚îÄ‚îÄ üì• 01_Entrada/              # Facturas nuevas sin procesar
‚îú‚îÄ‚îÄ üì§ 02_Procesadas/           # Facturas renombradas y organizadas
‚îÇ   ‚îú‚îÄ‚îÄ 2025/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 01_Enero/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ 02_Febrero/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îÇ   ‚îî‚îÄ‚îÄ 2024/
‚îú‚îÄ‚îÄ ‚ö†Ô∏è 03_Errores/              # Facturas con problemas
‚îî‚îÄ‚îÄ üìä 04_Logs/                 # Registros de procesamiento
                </div>
            </section>

            <!-- Requisitos -->
            <section>
                <h2>üìã Requisitos Previos</h2>
                <div class="card">
                    <h4>Licencias necesarias:</h4>
                    <ul>
                        <li>Microsoft 365 E3 o E5 (recomendado)</li>
                        <li>Cr√©ditos de AI Builder (incluidos en algunas licencias)</li>
                        <li>SharePoint Online o OneDrive for Business</li>
                    </ul>
                    
                    <h4>Permisos necesarios:</h4>
                    <ul>
                        <li>Permisos de administrador para configurar Power Automate</li>
                        <li>Acceso a AI Builder</li>
                        <li>Permisos de carpetas en SharePoint/OneDrive</li>
                    </ul>
                </div>
            </section>

            <!-- M√©tricas de √âxito -->
            <section>
                <h2>üìä M√©tricas de √âxito</h2>
                <div class="card card-success">
                    <ul>
                        <li>üìà <strong>Tasa de precisi√≥n:</strong> >95% en extracci√≥n de datos</li>
                        <li>‚è±Ô∏è <strong>Tiempo de procesamiento:</strong> <2 minutos por factura</li>
                        <li>üéØ <strong>Automatizaci√≥n:</strong> 100% sin intervenci√≥n manual</li>
                        <li>‚ùå <strong>Tasa de error:</strong> <5% (con manejo autom√°tico)</li>
                        <li>üí∞ <strong>Ahorro de tiempo:</strong> Estimado 80-90% vs proceso manual</li>
                    </ul>
                </div>
            </section>

            <!-- Pr√≥ximos Pasos -->
            <section>
                <h2>üöÄ Pr√≥ximos Pasos</h2>
                <div class="card card-info">
                    <ol>
                        <li><strong>Validar licencias:</strong> Confirmar acceso a Power Automate y AI Builder</li>
                        <li><strong>Recopilar muestras:</strong> 20-30 facturas de ejemplo de diferentes proveedores</li>
                        <li><strong>Definir nomenclatura final:</strong> Aprobar formato de nombres</li>
                        <li><strong>Crear entorno de pruebas:</strong> Carpetas y flujo b√°sico</li>
                        <li><strong>Desarrollo incremental:</strong> Implementar por fases</li>
                        <li><strong>Capacitaci√≥n:</strong> Formar al equipo en el uso del sistema</li>
                    </ol>
                </div>
            </section>

            <!-- Preguntas Pendientes -->
            <section>
                <h2>‚ùì Preguntas a Resolver</h2>
                <div class="card card-warning">
                    <ul>
                        <li>¬øTienen acceso a Power Automate y AI Builder?</li>
                        <li>¬øCu√°l es el volumen mensual aproximado de facturas?</li>
                        <li>¬øHay proveedores con formatos especiales que requieran atenci√≥n?</li>
                        <li>¬øNecesitan integraci√≥n con alg√∫n sistema contable (SAP, Dynamics, etc.)?</li>
                        <li>¬øRequieren notificaciones autom√°ticas?</li>
                        <li>¬øNecesitan hist√≥rico de cambios y auditor√≠a?</li>
                    </ul>
                </div>
            </section>
        </div>

        <footer>
            <p><strong>Proyecto: Renombrar_facturas</strong></p>
            <p>Repositorio: <a href="https://github.com/DavidL-Hafesa/Renombrar_facturas.git" style="color: #4da6ff;">github.com/DavidL-Hafesa/Renombrar_facturas</a></p>
            <p style="margin-top: 10px; font-size: 0.9em;">Documento generado el 1 de octubre de 2025</p>
        </footer>
    </div>
</body>
</html>
